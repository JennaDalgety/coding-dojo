<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css">
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">
  <link rel="stylesheet" href="style.css">
  <style>

  </style>
  <script src="http://code.jquery.com/jquery-2.2.4.js"   integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>  
  <script type="text/javascript">

    $(document).ready(function(){
      console.log("jQuery has loaded properly")

      var score = 0;

      var gameActive = true;

      var lives = 3; 

      var world = [
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
      [2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],
      ];

      var pacman = {
        x: 1,
        y: 1
      }

      var ghost = {
        x:8,
        y:8
      };

      function displayWorld(){
        var output = '';

        for(var i = 0; i < world.length; i++){
          output += "\n<div class='row'>\n";
          for(var j = 0; j < world[i].length; j++){
            if(world[i][j] == 2)
              output += "<div class='brick'></div>";
            else if(world[i][j] == 1)
              output += "<div class='coin'></div>";
            if(world[i][j] == 0)
              output += "<div class='empty'></div>";
          }
          output += "\n</div>";
        }
        document.getElementById('world').innerHTML = output;
      }

      function displayPacman(){
        document.getElementById('pacman').style.top = pacman.y*20+"px";
        document.getElementById('pacman').style.left = pacman.x*20+"px";
      }


      function displayGhost(){
        document.getElementById('ghost').style.top = ghost.y*20+"px";
        document.getElementById('ghost').style.left = ghost.x*20+"px";
      }

      function moveGhost(){
        var random = Math.floor(Math.random() * 4) + 37;
        switch(random){
          case 37:
          if(world[ghost.y][ghost.x-1] != 2){
            ghost.x--;
          }
          break;
          case 38:
          if(world[ghost.y-1][ghost.x] != 2){
            ghost.y--;
          }
          break;
          case 39:
          if(world[ghost.y][ghost.x+1] != 2){
            ghost.x++;
          }
          break;
          case 40:
          if(world[ghost.y+1][ghost.x] != 2){
            ghost.y++;
          }
          break;
        }
        if(ghost.y === pacman.y && ghost.x === pacman.x){
          lives -= 1;
        }
        if(lives === 0){
          gameActive = false;
        }
        displayScore();
        if(gameActive){
          displayGhost();
          displayWorld();
        }
      }

      setInterval(moveGhost, 500);

      function displayScore(){
        document.getElementById('points').innerHTML = score;
        document.getElementById('lives').innerHTML = lives;
      }

      displayWorld();
      displayPacman();
      displayScore();
      displayGhost();
      moveGhost();

      document.onkeydown = function(e){
        if(e.keyCode == 37 && world[pacman.y][pacman.x-1] != 2){
          pacman.x--;
          $('#pacman').css('transform', 'rotate(180deg)')
        }
        else if(e.keyCode == 39 && world[pacman.y][pacman.x+1] != 2){
          pacman.x++;
          $('#pacman').css('transform', 'rotate(0deg)')
        }
        else if(e.keyCode == 38 && world[pacman.y-1][pacman.x] != 2){
          pacman.y--;
          $('#pacman').css('transform', 'rotate(270deg)')
        }
        else if(e.keyCode == 40 && world[pacman.y+1][pacman.x] != 2){
          pacman.y++;
          $('#pacman').css('transform', 'rotate(90deg)')
        }

        if(world[pacman.y][pacman.x] == 1){
          world[pacman.y][pacman.x] = 0;
          score += 100;
        }
        if(gameActive){
          displayWorld();
          displayScore();
          displayPacman();
          displayGhost();
        }
      }

    });

  </script>
  <title>Pacman Demo</title>
</head>
<body>

  <div id="world"></div>

  <div id="pacman"></div>

  <div id="ghost"></div>

  <div id="score">
    <p>Score: <span id="points"></span></p>
    <p>Lives: <span id="lives"></span></p>
  </div>

</body>
</html>